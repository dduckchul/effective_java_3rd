# 8장 메서드

## 아이템49 / 매개변수가 유효한지 검사하라

#### 메서드 매개변수
* 제약은 반드시 문서화해야 하며 메서드 몸체가 시작되기 전에 검사해야 한다.
* public과 protected 메서드는 매개변수 값이 잘못됐을 때 던지는 예외를 문서화해야 한다(@throws 자바독 태그를 사용).
* 자바 7에 추가된 java.util.Objects.requireNonNull 메서드를 통해 더 이상 null 검사를 수동으로 하지 않아도 된다(예외 메세지 지정도 가능).
* public이 아닌 메서드라면 단언문(assert)을 사용해 매개변수 유효성을 검증할 수 있다. -> 무조건 참이라고 선언한다.
* "나중에 쓰려고 저장하는 매개변수의 유효성을 검사하라"

#### 생성자 매개변수
* "나중에 쓰려고 저장하는 매개변수의 유효성을 검사하라"는 원칙의 특수한 사례다.

#### 메서드는 최대한 범용적으로
* 메서드가 건네받은 값으로 무언가 제대로 된 일을 할 수 있다면 매개변수 제약은 적을수록 좋다.

#### 핵심 정리
* 메서드나 생성자를 작성할 때면 그 매개변수들에 어떤 제약이 있을지 생각하라.
* 제약들을 문서화하고 메서드 코드 시작 부분에서 명시적으로 검사해야 한다.

## 아이템50 / 적시에 방어적 복사본을 만들라
* 클라이언트가 불변식을 깨뜨리려 혈안이 되어 있다고 가정하고 방어적으로 프로그래밍해야 한다.
* 생성자에서 받은 가변 매개변수 각각을 방어적으로 복사해야 하고, 인스턴스 안에서는 원본이 아닌 복사본을 사용한다.
```java
// 생성자를 수정 - 여전히 Period 인스턴스는 변경 가능하다.
public Period(Date start, Date end) {
  this.start = new Date(start.getTime());
  this.end = new Date(end.getTime());
  
  if(this.start.compareTo(this.end) > 0) {
    ...
  }
}

* 매개변수의 유효성을 검사하기 전에 방어적 복사본을 만들고, 이 복사본으로 유효성을 검사한 점에 주목하자.
* 매개변수가 제3자에 의해 확장될 수 있는 타입이라면 방어적 복사본을 만들 때 clone을 사용해서는 안된다.
```
```java
// 접근자 - 완벽한 불변이다.
public Date start() {
  return new Date(start.getTime());
}

public Date end() {
  return new Date(end.getTime());
}

* 생성자와 달리 접근자 메서드에서는 방어적 복사에 clone을 사용해도 된다.
```

#### 핵심 정리
* 클래스가 클라이언트로부터 받는 혹은 클라이언트로 반환하는 구성요소가 가변이라면 그 요소는 반드시 방어적으로 복사해야 한다.
* 복사 비용이 너무 크거나 클라이언트가 그 요소를 잘못 수정할 일이 없음을 신뢰한다면 방어적 복사 대신 문서에 명시하도록 한다.

## 아이템51 / 메서드 시그니처를 신중히 설계하라
1. 메서드 이름을 신중히 짓자.
- 표준 명명 규칙을 따라야 한다. 자바 라이브러리의 API 가이드를 참조하면 좋다.
2. 편의 메서드를 너무 많이 만들지 말자.
- 메서드가 너무 많은 클래스는 익히고, 사용하고, 문서화하고, 테스트하고, 유지보수하기 어렵다. 인터페이스도 마찬가지다.
3. 매개변수 목록은 짧게 유지하자.
- 4개 이하가 좋다. 같은 타입의 매개변수 여러 개가 연달아 나오는 경우가 특히 해롭다.
- 1) 여러 메서드로 쪼갠다.
- 2) 매개변수 여러 개를 묶어주는 도우미 클래스를 만든다.
- 3) 빌더 패턴을 메서드 호출에 응용한다.
4. 매개변수의 타입으로는 클래스보다는 인터페이스가 더 낫다.
5. boolean보다는 원소 2개짜리 열거 타입이 낫다.

## 아이템52 / 다중정의는 신중히 사용하라
